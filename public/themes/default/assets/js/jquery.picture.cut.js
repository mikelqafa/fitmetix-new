$(function(){__IMAGE_LOADING="",PcDialog=function(e,t,i,o,n,r,a,d,l,p){if(t=null==t?"PictureCutDialog"+Math.round(99*Math.random()):t,$dialog=$("<div></div>").attr({id:t}),0<$("#"+t).size())return!1;$dialog.css({overflow:"hidden","background-image":"url("+__IMAGE_LOADING+")","background-repeat":"no-repeat","background-position":"center"}),$("body").prepend($dialog),$dialog.dialog({draggable:a,modal:r,width:o,height:n,title:i,resizable:d,zIndex:100,close:function(e,t){$(this).dialog("destroy").remove()}}),l=null==l?{}:l,$.post(e,l,function(e){$dialog.html(e),$dialog.css({"background-image":"none"}),"function"==typeof p&&p.call(this,$dialog)})},PcAlert=function(e,t,i){t=void 0===(i=void 0===i?function(){}:i)?"":t,$Dialog=$('<div id="dialog-PcAlert" ></div>').html(e).css({padding:"15px","max-height":405,overflow:"auto"}),$("body").prepend($Dialog),$Dialog.dialog({modal:!0,resizable:!1,zIndex:100,width:450,title:t,buttons:{Ok:function(){$(this).dialog("destroy").remove(),"function"==typeof i&&i.call(this)}},beforeClose:function(e,t){$(this).dialog("destroy").remove()}})},PcLoading={show:function(e,t){var i=$("<div id='dialog-UiConfirm' ></div>");e=void 0===e?"Wait...":e,t=void 0===t?"Wait!":t;var o=$("<div></div>").css("margin","15px"),n=$("<img src='"+__IMAGE_LOADING+"' >").css({float:"left","margin-right":"20px","margin-top":"-5px"});$MsgContent=$("<div>"+e+"</div>"),o.append(n).append($MsgContent),i.append(o),$("body").prepend(i),i.dialog({modal:!0,resizable:!1,zIndex:100,width:450,title:t,create:function(e,t){$(this).parent().children(".ui-dialog-titlebar").children(".ui-dialog-titlebar-close").hide()}})},hide:function(){var e=$("#dialog-UiConfirm");0<e.size()&&e.dialog("destroy").remove()}}}),function(e){var t;e.fn.uploadAjax=function(i){var o=e.extend({accept:/^(jpg|png|gif)/gi,acceptEx:"",name:"file",method:"POST",url:"/",data:!1,onSubmit:function(){return!0},onComplete:function(){return!0},extError:function(){return!1}},i);return this.each(function(){var i=e(this);i.css("position","relative"),i.setData=function(e){o.data=e};var n=e('<form  method="'+o.method+'" enctype="multipart/form-data" action="'+o.url+'"> <input name="'+o.name+'" type="file" accept="'+o.acceptEx+'" /></form>'),r=n.find("input[name="+o.name+"]");r.css({display:"block",position:"absolute",left:0,top:0,width:i.width(),height:i.height(),"font-size":"100pt",cursor:"hand",opacity:0,filter:"alpha(opacity=0)","z-index":10,overflow:"hidden"}).attr("title","Choose a picture"),r.on("change",function(t){if(t=(t=r.val().replace(/C:\\fakepath\\/i,"")).substring(t.lastIndexOf(".")+1),!o.accept.test(t))return o.extError.call(i,this),n.get(0).reset(),!1;n.find("input[type=hidden]").remove(),o.onSubmit.call(i,e(this)),o.data&&e.each(o.data,function(t,i){n.append(e('<input type="hidden" name="'+t+'" value="'+i+'">'))}),n.submit(),e(n).find("input[type=file]").attr("disabled","disabled")}),e(i).append(n),t||((t=e('<iframe id="picture-element-iframe" name="picture-element-iframe"></iframe>').attr("style",'style="width:0px;height:0px;border:0px solid #fff;"').hide()).attr("src",""),e(document.body).append(t));var a=function(){e(n).find("input[type=file]").removeAttr("disabled");var r=e(this).contents().find("html body").text();e(n).get(0).reset(),o.onComplete.call(i,r),t.unbind()};n.submit(function(e){t.load(a),n.attr("target","picture-element-iframe"),e.stopPropagation()})})}}(jQuery),function(e){var t={clear:function(t){return this.each(function(){e(this).find(".picture-element-image-directory").val("").change()})},init:function(t){var i="src/php/upload.php",o="src/php/crop.php",n="src/img/icon_add_image2.png",r={Extensions:["jpg","png","gif"],InputOfImageDirectory:"image",InputOfImageDirectoryAttr:{},InputOfFile:"",ActionToSubmitUpload:"",ActionToSubmitCrop:"",FolderOnServer:"",ThumbFolderOnServer:"",DataPost:{},DefaultImageButton:"",EnableCrop:!1,EnableResize:!0,MinimumWidthToResize:1024,MinimumHeightToResize:630,MaximumSize:1024,EnableMaximumSize:!1,PluginFolderOnServer:"",CropWindowStyle:"bootstrap",ImageNameRandom:!0,EnableButton:!1,ImageButtonCSS:{border:"1px #CCC solid",width:170,height:150},CropModes:{widescreen:!0,letterbox:!0,free:!0},CropOrientation:!0,UploadedCallback:function(e){}};if(void 0!=t.ImageButtonCSS&&(t.ImageButtonCSS=e.extend(r.ImageButtonCSS,t.ImageButtonCSS)),void 0!=(t=e.extend(r,t)).CropModes&&(t.CropModes=e.extend(r.CropModes,t.CropModes)),""==t.FolderOnServer)return alert("ATTENTION:\nFolderOnServer parameter must be set"),!1;if(""==t.PluginFolderOnServer)return alert("ATTENTION:\nPluginFolderOnServer parameter must be set"),!1;if(t.PluginFolderOnServer.length>0&&("/"!=t.PluginFolderOnServer.charAt(t.PluginFolderOnServer.length-1)&&(t.PluginFolderOnServer+="/"),"/"!=t.PluginFolderOnServer.charAt(0)&&(t.PluginFolderOnServer="/"+t.PluginFolderOnServer)),t.ActionToSubmitUpload=""==t.ActionToSubmitUpload?t.PluginFolderOnServer+i:t.ActionToSubmitUpload,t.ActionToSubmitCrop=""==t.ActionToSubmitCrop?t.PluginFolderOnServer+o:t.ActionToSubmitCrop,t.DefaultImageButton=""==t.DefaultImageButton?t.PluginFolderOnServer+n:t.DefaultImageButton,t.CropWindowStyle=t.CropWindowStyle.toLowerCase(),""==t.InputOfFile&&(t.InputOfFile="file-"+t.InputOfImageDirectory),__IMAGE_LOADING=t.PluginFolderOnServer+"src/img/ajaxloader.gif",void 0!=t.PastaCrop&&(t.PluginFolderOnServer=t.PastaCrop),"bootstrap"==t.CropWindowStyle.toLowerCase()){var a="picture_element_css_to_bootstrap";0==e("#"+a).size()&&e("<link/>",{id:a,rel:"stylesheet",type:"text/css",href:t.PluginFolderOnServer+"src/windows/JanelaBootstrap/jquery-ui-1.10.0.custom.css"}).appendTo("head")}var d="picture_basic_dependence_css";return 0==e("#"+d).size()&&e('<style type="text/css" id="'+d+'">.picture-element-principal{background:url('+t.DefaultImageButton+") no-repeat 50% 50%}.picture-dropped{border:2px #666 dashed!important;}</style>").appendTo("head"),this.each(function(){var i,o,n={jqueryui:"src/windows/window.jqueryui.php",popstyle:"src/windows/window.popstyle.php",bootstrap:"src/windows/window.bootstrap.php"};JpaneDialogCrop=function(i,o,n,r,a,d,l,p,u){$dialog=e("<div id='JtuyoshiCrop' class='JtuyoshiContainerElement' ></div>");var s=(e(window).width()-n)/2,c=(e(window).height()-r)/2;$dialog.css({position:"absolute",left:s,top:c,width:n,height:r,border:"1px #CCC solid","background-color":"#FFF","background-image":"url("+__IMAGE_LOADING+")","background-repeat":"no-repeat","background-position":"center","z-index":600,"-webkit-box-shadow":"0px 0px 80px 0px rgba(0, 0, 0, 0.7)","box-shadow":"0px 0px 80px 0px rgba(0, 0, 0, 0.7)"});var h=e("<div id='JtuyoshiCrop_model' />").css({position:"absolute",left:0,top:0,width:"100%",height:"100%",border:"1px #CCC solid","background-image":"url("+__IMAGE_LOADING+")","background-image":"url("+t.PluginFolderOnServer+"src/img/fundo_crop.png)","z-index":598});a&&e("body").append(h),e("body").append($dialog),e.post(i,p,function(e){$dialog.html(e),$dialog.css({"background-image":"none"}),"function"==typeof u&&u.call(this,$dialog)})};var r=function(i,o,a){o=o;1!=a&&t.EnableCrop?function(i,o){o=o;var a=function(i,n){var r,a,d=o.currentWidth/100*80,l=d/16*9;if(i.css({width:d,height:l,left:(o.currentWidth-d)/2,top:(o.currentHeight-l)/2}),r=e("#JtuyoshiCrop #SelectProporcao"),a=e("#JtuyoshiCrop #SelectOrientacao"),"create"==n)if(t.CropModes.widescreen||t.CropModes.letterbox||t.CropModes.free?r.show():(r.hide(),a.parent().hide(),a.hide(),a.parent().hide()),t.CropModes.widescreen&&r.append(e('<option value="wide">16:9</option>')),t.CropModes.letterbox&&r.append(e('<option value="box">4:3</option>')),t.CropModes.free&&r.append(e('<option value="livre">Free</option>')),t.CropModes.widescreen||t.CropModes.letterbox&&t.CropOrientation?a.append('<option value="Horizontal">Landscape</option>').append('<option value="Vertical">Portrait</option>  '):(a.append('<option value="Horizontal" selected>Portrait</option>'),a.hide(),a.parent().hide()),r.find("option").size()>0&&r.find("option:first-child").attr("selected","selected"),i.draggable({containment:"parent"}),"livre"==r.val())l=d=o.currentWidth/100*80,i.css({width:d,height:l,left:(o.currentWidth-d)/2,top:(o.currentHeight-l)/2}),i.resizable({containment:"parent",minWidth:d/100*10,minHeight:l/100*10});else{var p=0;"wide"==r.val()?(p=16/9,l=(d=o.currentWidth/100*80)/16*9):(p=4/3,l=(d=o.currentWidth/100*80)/4*3),i.css({width:d,height:l,left:(o.currentWidth-d)/2,top:(o.currentHeight-l)/2}),i.resizable({containment:"parent",aspectRatio:p,minWidth:d/100*10,minHeight:l/100*10})}l>o.currentHeight&&(d=16*(l=o.currentHeight/100*80)/9,i.css({width:d,height:l,left:(o.currentWidth-d)/2,top:(o.currentHeight-l)/2})),r.change()},d=function(){if(o.currentWidth+80>410)if("jqueryui"==t.CropWindowStyle)e("#JtuyoshiCrop").dialog("option",{width:o.currentWidth+40,height:o.currentHeight+110}),e("#JtuyoshiCrop").dialog("option","position",{my:"center",at:"center",of:window});else if("popstyle"==t.CropWindowStyle){var i=(e(window).width()-o.currentWidth)/2,n=(e(window).height()-o.currentHeight)/2;e("#JtuyoshiCrop").css({width:o.currentWidth,height:o.currentHeight,left:i,top:n})}else"bootstrap"==t.CropWindowStyle&&(e("#JtuyoshiCrop").dialog("option",{width:o.currentWidth+40,height:o.currentHeight+130}),e("#JtuyoshiCrop").dialog("option","position",{my:"center",at:"center",of:window}));else"jqueryui"==t.CropWindowStyle?(e("#JtuyoshiCrop").dialog("option",{width:410,height:o.currentHeight+110}),e("#JtuyoshiCrop").dialog("option","position",{my:"center",at:"center",of:window})):"popstyle"==t.CropWindowStyle?(i=(e(window).width()-410)/2,n=(e(window).height()-o.currentHeight)/2,e("#JtuyoshiCrop").css({width:410,height:o.currentHeight,left:i,top:n})):"bootstrap"==t.CropWindowStyle&&(e("#JtuyoshiCrop").dialog("option",{width:410,height:o.currentHeight+130}),e("#JtuyoshiCrop").dialog("option","position",{my:"center",at:"center",of:window}))},l=function(e,i){e.css({border:"2px #ccc solid",width:o.currentWidth,height:o.currentHeight}),i.css({width:o.currentWidth,height:o.currentHeight}).attr("src",t.FolderOnServer+o.currentFileName+"?"+Math.round(9999*Math.random()))},p=function(){e.getScript(t.PluginFolderOnServer+"src/windows/core/window.pc.js");var n=e("#JtuyoshiCrop #Principal"),p=e("<img />");n.append(p),l(n,p),a(e("#JtuyoshiCrop #SelecaoRecorte"),"create"),d(),e("#JtuyoshiCrop #button_crop_original").bind("click",function(){r(i,o,1)}),e("#JtuyoshiCrop #button_crop_recortar").bind("click",function(){var i=e(this);i.attr("disabled","disabled"),PcLoading.show();var r=o;r.request="crop",r.folderOnServer=t.FolderOnServer,r.inputOfFile=t.InputOfFile,r.maximumSize=t.MaximumSize,r.enableMaximumSize=t.EnableMaximumSize,r.toCropImgX=e("#JtuyoshiCrop #SelecaoRecorte").position().left,r.toCropImgY=e("#JtuyoshiCrop #SelecaoRecorte").position().top,r.toCropImgW=e("#JtuyoshiCrop #SelecaoRecorte").width(),r.toCropImgH=e("#JtuyoshiCrop #SelecaoRecorte").height(),r.currentFileName=o.currentFileName.substring(o.currentFileName.lastIndexOf("/")+1);var u=""==t.ActionToSubmitCrop?t.ActionToSubmitUpload:t.ActionToSubmitCrop;e.post(u,r,function(t){i.removeAttr("disabled"),PcLoading.hide(),(o=t).currentWidth=parseInt(o.currentWidth),o.currentHeight=parseInt(o.currentHeight),l(n,p),a(e("#JtuyoshiCrop #SelecaoRecorte")),d()},"JSON")})};"jqueryui"==t.CropWindowStyle?PcDialog(t.PluginFolderOnServer+n[t.CropWindowStyle],"JtuyoshiCrop","Crop image",900,555,!0,!0,!1,null,p):"popstyle"==t.CropWindowStyle?JpaneDialogCrop(t.PluginFolderOnServer+n[t.CropWindowStyle],"Crop image",980,555,!0,!1,!1,null,p):"bootstrap"==t.CropWindowStyle&&PcDialog(t.PluginFolderOnServer+n[t.CropWindowStyle],"JtuyoshiCrop","Crop image",900,555,!0,!0,!1,null,p)}(i,o):("jqueryui"==t.CropWindowStyle||"bootstrap"==t.CropWindowStyle?e("#JtuyoshiCrop").dialog("destroy").remove():"popstyle"==t.CropWindowStyle&&(e("#JtuyoshiCrop").remove(),e("#JtuyoshiCrop_model").remove()),function(){i.children("input[name='"+t.InputOfImageDirectory+"']").val(t.FolderOnServer+o.currentFileName).change(),"function"==typeof t.UploadedCallback&&(o.options={FolderOnServer:t.FolderOnServer},t.UploadedCallback.call(this,o))}())};e(this).html(""),function(n){n.css(e.extend(t.ImageButtonCSS,{position:"relative",cursor:"pointer",overflow:"hidden"})).addClass("picture-element-principal"),n.on("dragenter",function(i){e(i.target).attr("name")==t.InputOfFile?n.addClass("picture-dropped"):n.removeClass("picture-dropped"),i.stopPropagation(),i.preventDefault()}),e(document).on("drop dragend",function(e){console.log(n),n.removeClass("picture-dropped"),e.stopPropagation()}),n.on("mouseout",function(e){n.removeClass("picture-dropped"),e.stopPropagation()});var r=e("<img src='data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==' class='picture-element-image'>");r.css({position:"relative",cursor:"pointer"}),r.css({height:t.ImageButtonCSS.height}),n.append(r);var a=e("<input type='hidden' name='"+t.InputOfImageDirectory+"' id='"+t.InputOfImageDirectory+"'>");a.addClass("picture-element-image-directory"),n.append(a),a.attr(t.InputOfImageDirectoryAttr),a.bind("change",function(){var n;""!=e(this).val()?(n=""!=t.ThumbFolderOnServer?t.ThumbFolderOnServer+e(this).val().substring(e(this).val().lastIndexOf("/")+1):t.FolderOnServer+e(this).val().substring(e(this).val().lastIndexOf("/")+1),r.removeAttr("style"),r.css({position:"relative",cursor:"pointer"}),r.attr("src",n),t.EnableButton&&o.unbind("click").bind("click",function(){a.val("").change()}).val("Remove Picture"),r.on("load",function(){console.log("load"),e(this).height()<e(this).width()?(e(this).css({height:t.ImageButtonCSS.height}),e(this).css({width:"none"})):e(this).width()<e(this).height()?(e(this).css({width:t.ImageButtonCSS.width}),e(this).css({height:"none"})):(e(this).css({width:t.ImageButtonCSS.width}),e(this).css({height:t.ImageButtonCSS.height}))}).each(function(){this.complete&&e(this).load()})):(r.attr("src","data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw=="),t.EnableButton&&o.unbind("click").bind("click",function(){i.find("input[name='"+t.InputOfFile+"']:file").click()}).val("Selecionar imagem"))})}(i=e(this)),function(i){var o=t.DataPost;o.request="upload",o.inputOfFile=t.InputOfFile,o.enableResize=t.EnableResize,o.minimumWidthToResize=t.MinimumWidthToResize,o.minimumHeightToResize=t.MinimumHeightToResize,o.folderOnServer=t.FolderOnServer,o.imageNameRandom=t.ImageNameRandom,o.maximumSize=t.MaximumSize,o.enableMaximumSize=t.EnableMaximumSize;var n=new RegExp("^("+t.Extensions.join("|")+")","i");i.uploadAjax({accept:n,acceptEx:"image/*",name:t.InputOfFile,method:"POST",url:t.ActionToSubmitUpload,data:o,onSubmit:function(){PcLoading.show()},onComplete:function(t){t=e.parseJSON(t),PcLoading.hide(),t.status?r(i,t):PcAlert(t.errorMessage,"Attention")},extError:function(){PcAlert("types are supported: "+t.Extensions.join(",").toString(),"Attention")}}),i.find(":file[name='"+t.InputOfFile+"']").mouseenter(function(){i.addClass("TuyoshiImageUpload_div")}).mouseout(function(){i.removeClass("TuyoshiImageUpload_div")})}(i),t.EnableButton&&(o=e("<input type='button' value='Selecionar imagem' />").button().css({"font-size":"12px","margin-top":5,"margin-left":"-0.5px"}),i.after(o),o.unbind("click").bind("click",function(){i.find("input[name='"+t.InputOfFile+"']:file").click()}))})}};e.fn.PictureCut=function(e){if(void 0===window.jQuery.ui)alert("Could not instantiate the PictureCut is missing jquery.ui");else{if(t[e])return t[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return t.init.apply(this,arguments)}}}(jQuery);